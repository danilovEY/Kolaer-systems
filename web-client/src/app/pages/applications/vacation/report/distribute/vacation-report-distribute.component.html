<div class="row">
    <div class="col-12" #filterElement>
        <report-filter [pipeCharts]="true"
                       [(filterModel)]="filterModel"
                       [selectAllDepartments]="true"
                       [calculateIntersections]="true"
                       [departments]="departments"
                       (onChangeFilter)="changeFilter($event)"
                       (onAcceptFilter)="generateReportDistribute($event)">
        </report-filter>
    </div>

    <div class="col-12" *ngIf="vacationReportDistribute && vacationReportDistribute.lineValues.length > 0">
        <nb-card>
            <nb-card-header>
                <span>График распределений</span>
            </nb-card-header>

            <nb-card-body id="chart">
                <ngx-charts-line-chart
                        [scheme]="colorScheme"
                        [view]="lineView"
                        [results]="vacationReportDistribute.lineValues"
                        [xAxis]="true"
                        [yAxis]="true"
                        [gradient]="false"
                        [animations]="false"
                        [legend]="true"
                        [timeline]="false"
                        [autoScale]="true"
                        [showGridLines]="true"
                        [showXAxisLabel]="false"
                        [showYAxisLabel]="true"
                        legendTitle="Подразделения"
                        xAxisLabel="Месяцы"
                        yAxisLabel="Количество сотрудников">
                </ngx-charts-line-chart>
            </nb-card-body>

            <nb-card-footer>
                <button class="btn btn-success" (click)="downloadChart()">Скачать график</button>
            </nb-card-footer>
        </nb-card>
    </div>

    <div *ngIf="vacationReportDistribute && vacationReportDistribute.pipeValues.length > 0">
        <div class="col-12" *ngFor="let pipeModel of vacationReportDistribute.pipeValues">
            <nb-card>
                <nb-card-header>
                    <span>Процентное соотношение для {{ pipeModel.name }}</span>
                </nb-card-header>

                <nb-card-body>
                    <ngx-charts-pie-grid [results]="pipeModel.values"
                                         [view]="pipeView"
                                         [animations]="false"
                                         [designatedTotal]="pipeModel.totalValue">
                    </ngx-charts-pie-grid>
                </nb-card-body>
            </nb-card>
        </div>
    </div>
</div>